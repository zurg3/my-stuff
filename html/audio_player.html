<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Audio player</title>
    <script src="https://cdn.jsdelivr.net/gh/zurg3/my-stuff@master/js/lib.min.js"></script>
    <style>
      audio:focus {
        outline: none;
      }
    </style>
  </head>
  <body>
    <form id="form" hidden>
      <p>
        <label for="audio_src">Audio link</label>
        <input type="url" id="audio_src" size="60" autocomplete="off">
      </p>
      <p>
        <input type="button" id="open_audio_button" value="Submit" onclick="open_audio()">
        <input type="button" id="fit_audio_button" value="Fit audio" onclick="fit_audio()" hidden>
        <input type="button" id="remove_audio_button" value="Remove audio" onclick="remove_audio()" hidden>
      </p>
    </form>
    <hr>
    <div id="audio_player"></div>
    <script>
      if (is_mobile()) {
        const url_input = document.getElementById('audio_src');
        const width = Math.floor(document.body.offsetWidth * 0.9);

        url_input.removeAttribute('size');
        url_input.style.width = `${width}px`;
      }

      const form = document.getElementById('form');
      form.hidden = false;

      const audio = document.createElement('audio');
      const audio_link = document.getElementById('audio_src');

      function open_audio() {
        if (audio_link.value) {
          audio.src = audio_link.value;
          audio.controls = true;
          audio.preload = 'metadata';

          document.getElementById('audio_player').append(audio);

          document.getElementById('fit_audio_button').hidden = false;
          document.getElementById('remove_audio_button').hidden = false;
        }
      }

      function fit_audio() {
        audio.style.width = '100%';
      }

      function remove_audio() {
        audio_link.value = '';
        audio.remove();
        document.getElementById('fit_audio_button').hidden = true;
        document.getElementById('remove_audio_button').hidden = true;
      }
    </script>
  </body>
</html>
